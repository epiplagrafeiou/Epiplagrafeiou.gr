
{
  "entities": {
    "Supplier": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Supplier",
      "type": "object",
      "description": "Represents a supplier of products.",
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of the supplier."
        },
        "url": {
          "type": "string",
          "description": "URL of the supplier's XML feed.",
          "format": "uri"
        },
        "markupRules": {
          "type": "array",
          "description": "Rules for applying markup based on price ranges.",
          "items": {
            "type": "object",
            "properties": {
              "from": { "type": "number" },
              "to": { "type": "number" },
              "markup": { "type": "number" }
            },
            "required": ["from", "to", "markup"]
          }
        },
        "conversionRate": {
            "type": "number"
        },
        "profitability": {
            "type": "number"
        }
      },
      "required": [
        "name",
        "url",
        "markupRules"
      ]
    },
    "Product": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Product",
      "type": "object",
      "description": "Represents a product in the eShop.",
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of the product."
        },
        "slug": {
          "type": "string",
          "description": "URL-friendly slug for the product."
        },
        "description": {
          "type": "string",
          "description": "A description of the product."
        },
        "price": {
          "type": "number",
          "description": "The price of the product."
        },
        "originalPrice": {
          "type": "number"
        },
        "categoryId": {
          "type": ["string", "null"],
          "description": "The ID of the curated category this product belongs to."
        },
        "imageId": {
            "type": "string",
            "description": "URL of the primary product image."
        },
        "images": {
            "type": "array",
            "description": "Array of image URLs for the product gallery.",
            "items": {
                "type": "string",
                "format": "uri"
            }
        },
        "stock": {
            "type": "number",
            "description": "Available stock quantity."
        },
        "supplierId": {
          "type": "string",
          "description": "Reference to the supplier for this product."
        },
         "rawCategory": {
          "type": "string",
          "description": "The original, unprocessed category string from the supplier's XML feed."
        },
        "variantGroupKey": {
            "type": "string",
            "description": "A key to group product variants (e.g., by color)."
        },
        "color": {
            "type": "string",
            "description": "The color of the product variant."
        },
        "sku": {
            "type": "string"
        },
        "model": {
            "type": "string"
        }
      },
      "required": [
        "name",
        "slug",
        "description",
        "price",
        "imageId",
        "images",
        "stock",
        "supplierId"
      ]
    },
     "Category": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Category",
      "type": "object",
      "description": "Represents a curated store category.",
      "properties": {
        "name": {
          "type": "string",
          "description": "The display name of the category."
        },
        "slug": {
          "type": "string",
          "description": "URL-friendly slug for the category."
        },
        "parentId": {
          "type": ["string", "null"],
          "description": "The ID of the parent category, or null for a top-level category."
        },
        "path": {
          "type": "string",
          "description": "The full slug path of the category (e.g., 'furniture/desks')."
        },
        "rawCategories": {
          "type": "array",
          "description": "A list of raw category strings from suppliers that are mapped to this curated category.",
          "items": {
            "type": "string"
          }
        },
        "order": {
          "type": "number",
          "description": "The display order of the category within its level."
        }
      },
      "required": ["name", "slug", "path", "rawCategories", "order"]
    },
    "UserProfile": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "User Profile",
        "description": "Represents a user's profile information.",
        "type": "object",
        "properties": {
            "id": {
                "type": "string",
                "description": "The unique identifier for the user, matching the auth UID."
            },
            "email": {
                "type": "string",
                "format": "email",
                "description": "The user's email address."
            },
            "name": {
                "type": "string",
                "description": "The user's display name."
            },
            "points": {
                "type": "number",
                "description": "The user's accumulated reward points."
            }
        },
        "required": ["id", "email", "name", "points"]
    },
    "Order": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Order",
      "description": "Represents a customer order.",
      "type": "object",
      "properties": {
        "userId": { "type": ["string", "null"] },
        "customerDetails": {
          "type": "object",
          "properties": {
            "name": { "type": "string" },
            "email": { "type": "string", "format": "email" },
            "phone": { "type": "string" }
          },
          "required": ["name", "email", "phone"]
        },
        "shippingAddress": {
          "type": "object",
          "properties": {
            "address": { "type": "string" },
            "city": { "type": "string" },
            "postalCode": { "type": "string" },
            "country": { "type": "string" }
          },
          "required": ["address", "city", "postalCode", "country"]
        },
        "companyDetails": {
          "type": ["object", "null"],
          "properties": {
            "name": { "type": "string" },
            "vat": { "type": "string" },
            "taxOffice": { "type": "string" },
            "address": { "type": "string" }
          },
          "required": ["name", "vat", "taxOffice", "address"]
        },
        "items": {
          "type": "array",
          "items": { "$ref": "#/entities/Product" }
        },
        "total": { "type": "number" },
        "status": { 
          "type": "string",
          "enum": ["Pending Payment", "Pending", "Shipped", "Delivered", "Cancelled"]
        },
        "paymentMethod": {
            "type": "string",
            "enum": ["stripe", "bank_transfer"]
        },
        "createdAt": { 
          "type": "string",
          "format": "date-time"
        }
      },
      "required": ["customerDetails", "shippingAddress", "items", "total", "status", "createdAt"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/suppliers/{supplierId}",
        "definition": {
          "entityName": "Supplier",
          "schema": {
            "$ref": "#/entities/Supplier"
          },
          "description": "Stores supplier information."
        }
      },
      {
        "path": "/products/{productId}",
        "definition": {
          "entityName": "Product",
          "schema": {
            "$ref": "#/entities/Product"
          },
          "description": "Stores all product information."
        }
      },
      {
        "path": "/categories/{categoryId}",
        "definition": {
          "entityName": "Category",
          "schema": {
            "$ref": "#/entities/Category"
          },
          "description": "Stores the curated category structure for the eShop."
        }
      },
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": {
            "$ref": "#/entities/UserProfile"
          },
          "description": "Stores user profile information, including reward points."
        }
      },
      {
        "path": "/orders/{orderId}",
        "definition": {
          "entityName": "Order",
          "schema": {
            "$ref": "#/entities/Order"
          },
          "description": "Stores customer orders."
        }
      }
    ]
  }
}
